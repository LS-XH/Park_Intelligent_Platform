import numpy as np

# 从data.json提取并处理的单向道路地图参数（所有坐标数字乘10）
obstacles_params = []

# 处理edges中的道路
edges = [
    {"start_id": 0, "end_id": 1}, {"start_id": 0, "end_id": 2}, {"start_id": 1, "end_id": 5},
    {"start_id": 2, "end_id": 6}, {"start_id": 2, "end_id": 3}, {"start_id": 3, "end_id": 4},
    {"start_id": 4, "end_id": 5}, {"start_id": 6, "end_id": 7}, {"start_id": 6, "end_id": 13},
    {"start_id": 3, "end_id": 7}, {"start_id": 7, "end_id": 8}, {"start_id": 7, "end_id": 14},
    {"start_id": 5, "end_id": 12}, {"start_id": 4, "end_id": 11}, {"start_id": 3, "end_id": 9},
    {"start_id": 8, "end_id": 9}, {"start_id": 9, "end_id": 10}, {"start_id": 10, "end_id": 11},
    {"start_id": 10, "end_id": 19}, {"start_id": 11, "end_id": 12}, {"start_id": 11, "end_id": 20},
    {"start_id": 12, "end_id": 21}, {"start_id": 8, "end_id": 15}, {"start_id": 13, "end_id": 14},
    {"start_id": 13, "end_id": 26}, {"start_id": 14, "end_id": 15}, {"start_id": 14, "end_id": 22},
    {"start_id": 15, "end_id": 16}, {"start_id": 16, "end_id": 17}, {"start_id": 17, "end_id": 18},
    {"start_id": 18, "end_id": 19}, {"start_id": 19, "end_id": 20}, {"start_id": 20, "end_id": 21},
    {"start_id": 20, "end_id": 25}, {"start_id": 16, "end_id": 22}, {"start_id": 22, "end_id": 23},
    {"start_id": 23, "end_id": 24}, {"start_id": 23, "end_id": 28}, {"start_id": 24, "end_id": 25},
    {"start_id": 25, "end_id": 30}, {"start_id": 26, "end_id": 27}, {"start_id": 27, "end_id": 28},
    {"start_id": 28, "end_id": 29}, {"start_id": 29, "end_id": 30}, {"start_id": 24, "end_id": 29},
    {"start_id": 17, "end_id": 24}, {"start_id": 22, "end_id": 26}, {"start_id": 18, "end_id": 25},
    {"start_id": 30, "end_id": 21}
]

# 所有坐标数字从乘3改为乘10
points_coords = [
    (469*10, 33*10), (536*10, 77*10), (328*10, 192*10), (368*10, 209*10), (467*10, 216*10),
    (567*10, 223*10), (182*10, 331*10), (279*10, 333*10), (321*10, 338*10), (419*10, 311*10),
    (474*10, 318*10), (538*10, 320*10), (602*10, 331*10), (195*10, 384*10), (284*10, 393*10),
    (328*10, 388*10), (368*10, 415*10), (416*10, 411*10), (469*10, 419*10), (469*10, 382*10),
    (540*10, 377*10), (600*10, 375*10), (328*10, 468*10), (357*10, 508*10), (430*10, 488*10),
    (527*10, 475*10), (237*10, 574*10), (248*10, 625*10), (324*10, 609*10), (452*10, 590*10),
    (593*10, 567*10)
]

# 生成道路参数
for edge in edges:
    start_idx = edge["start_id"]
    end_idx = edge["end_id"]
    start_point = points_coords[start_idx]
    end_point = points_coords[end_idx]
    obstacles_params.append({
        "start_point": start_point,
        "end_point": end_point,
        "width": 18,
        "gap_offset_ratio": 1.0
    })

# 添加地图边缘（根据坐标范围调整）
max_x = max(coord[0] for coord in points_coords) + 100
max_y = max(coord[1] for coord in points_coords) + 100
MAP_SIZE = max(max_x, max_y)
obstacles_params.extend([
    {"start_point": (0, 0), "end_point": (0, MAP_SIZE), "width": 3, "gap_offset_ratio": 0},
    {"start_point": (MAP_SIZE, 0), "end_point": (MAP_SIZE, MAP_SIZE), "width": 3, "gap_offset_ratio": 0},
    {"start_point": (0, 0), "end_point": (MAP_SIZE, 0), "width": 3, "gap_offset_ratio": 0},
    {"start_point": (0, MAP_SIZE), "end_point": (MAP_SIZE, MAP_SIZE), "width": 3, "gap_offset_ratio": 0}
])

# 节点名称列表
node_names = [
    "松风涧", "月栖滩", "云岫台", "花溪渡", "星垂浦", "竹影潭", "雾隐桥",
    "棠香坞", "枫径斜", "荷风榭", "砚池春", "书声崖", "画舫驿", "棋趣坪",
    "诗墙巷", "灯影廊", "拓片台", "弦歌榭", "忆旧轩", "问津亭", "雀跃坪",
    "蝶踪径", "萤火星", "风铃渡", "落英阶", "镜心湖", "踏浪矶", "叠翠屏",
    "听雪轩", "陆小凤", "小凤路"
]

# 目标点热度值（保留两位小数）
node_heat = [
    0.02, 0.04, 0.02, 0.01, 0.05, 0.09, 0.10, 0.03, 0.02, 0.04, 0.02, 0.04, 0.03,
    0.02, 0.01, 0.03, 0.02, 0.02, 0.03, 0.02, 0.05, 0.03, 0.03, 0.03, 0.01, 0.04,
    0.03, 0.03, 0.02, 0.02, 0.04
]

# 已生成的目标点（每个节点1-2个，确保不在边两侧12格范围内）
targets = np.array([
    # 松风涧 (0) - 2个目标点
    [4710.0, 310.0], [4650.0, 350.0],
    # 月栖滩 (1) - 1个目标点
    [5390.0, 790.0],
    # 云岫台 (2) - 2个目标点
    [3310.0, 1950.0], [3250.0, 1900.0],
    # 花溪渡 (3) - 1个目标点
    [3710.0, 2120.0],
    # 星垂浦 (4) - 2个目标点
    [4700.0, 2190.0], [4640.0, 2140.0],
    # 竹影潭 (5) - 1个目标点
    [5700.0, 2260.0],
    # 雾隐桥 (6) - 2个目标点
    [1850.0, 3340.0], [1790.0, 3290.0],
    # 棠香坞 (7) - 1个目标点
    [2820.0, 3360.0],
    # 枫径斜 (8) - 2个目标点
    [3240.0, 3410.0], [3180.0, 3360.0],
    # 荷风榭 (9) - 1个目标点
    [4220.0, 3140.0],
    # 砚池春 (10) - 2个目标点
    [4770.0, 3210.0], [4710.0, 3160.0],
    # 书声崖 (11) - 1个目标点
    [5410.0, 3230.0],
    # 画舫驿 (12) - 2个目标点
    [6050.0, 3340.0], [5990.0, 3290.0],
    # 棋趣坪 (13) - 1个目标点
    [1980.0, 3870.0],
    # 诗墙巷 (14) - 2个目标点
    [2870.0, 3960.0], [2810.0, 3910.0],
    # 灯影廊 (15) - 1个目标点
    [3310.0, 3910.0],
    # 拓片台 (16) - 2个目标点
    [3710.0, 4180.0], [3650.0, 4130.0],
    # 弦歌榭 (17) - 1个目标点
    [4190.0, 4140.0],
    # 忆旧轩 (18) - 2个目标点
    [4720.0, 4220.0], [4660.0, 4170.0],
    # 问津亭 (19) - 1个目标点
    [4720.0, 3850.0],
    # 雀跃坪 (20) - 2个目标点
    [5430.0, 3800.0], [5370.0, 3750.0],
    # 蝶踪径 (21) - 1个目标点
    [6030.0, 3780.0],
    # 萤火星 (22) - 2个目标点
    [3310.0, 4710.0], [3250.0, 4660.0],
    # 风铃渡 (23) - 1个目标点
    [3600.0, 5110.0],
    # 落英阶 (24) - 2个目标点
    [4330.0, 4910.0], [4270.0, 4860.0],
    # 镜心湖 (25) - 1个目标点
    [5300.0, 4780.0],
    # 踏浪矶 (26) - 2个目标点
    [2400.0, 5770.0], [2340.0, 5720.0],
    # 叠翠屏 (27) - 1个目标点
    [2510.0, 6280.0],
    # 听雪轩 (28) - 2个目标点
    [3270.0, 6120.0], [3210.0, 6070.0],
    # 陆小凤 (29) - 1个目标点
    [4550.0, 5930.0],
    # 小凤路 (30) - 2个目标点
    [5960.0, 5700.0], [5900.0, 5650.0]
])

# 对应的目标点热度值
targets_heat = [
    # 松风涧
    0.02, 0.02,
    # 月栖滩
    0.04,
    # 云岫台
    0.02, 0.02,
    # 花溪渡
    0.01,
    # 星垂浦
    0.05, 0.05,
    # 竹影潭
    0.09,
    # 雾隐桥
    0.05, 0.05,
    # 棠香坞
    0.03,
    # 枫径斜
    0.02, 0.02,
    # 荷风榭
    0.04,
    # 砚池春
    0.02, 0.02,
    # 书声崖
    0.04,
    # 画舫驿
    0.03, 0.03,
    # 棋趣坪
    0.02,
    # 诗墙巷
    0.01, 0.01,
    # 灯影廊
    0.03,
    # 拓片台
    0.02, 0.02,
    # 弦歌榭
    0.02,
    # 忆旧轩
    0.03, 0.03,
    # 问津亭
    0.02,
    # 雀跃坪
    0.05, 0.05,
    # 蝶踪径
    0.04,
    # 萤火星
    0.03, 0.03,
    # 风铃渡
    0.03,
    # 落英阶
    0.01, 0.01,
    # 镜心湖
    0.04,
    # 踏浪矶
    0.03, 0.03,
    # 叠翠屏
    0.03,
    # 听雪轩
    0.02, 0.02,
    # 陆小凤
    0.02,
    # 小凤路
    0.04, 0.04
]

# 所有点的坐标列表（保持乘10）
points = points_coords

# 目标点信息（来源节点）
targets_info = [
    "松风涧附近目标点", "松风涧附近目标点",
    "月栖滩附近目标点",
    "云岫台附近目标点", "云岫台附近目标点",
    "花溪渡附近目标点",
    "星垂浦附近目标点", "星垂浦附近目标点",
    "竹影潭附近目标点",
    "雾隐桥附近目标点", "雾隐桥附近目标点",
    "棠香坞附近目标点",
    "枫径斜附近目标点", "枫径斜附近目标点",
    "荷风榭附近目标点",
    "砚池春附近目标点", "砚池春附近目标点",
    "书声崖附近目标点",
    "画舫驿附近目标点", "画舫驿附近目标点",
    "棋趣坪附近目标点",
    "诗墙巷附近目标点", "诗墙巷附近目标点",
    "灯影廊附近目标点",
    "拓片台附近目标点", "拓片台附近目标点",
    "弦歌榭附近目标点",
    "忆旧轩附近目标点", "忆旧轩附近目标点",
    "问津亭附近目标点",
    "雀跃坪附近目标点", "雀跃坪附近目标点",
    "蝶踪径附近目标点",
    "萤火星附近目标点", "萤火星附近目标点",
    "风铃渡附近目标点",
    "落英阶附近目标点", "落英阶附近目标点",
    "镜心湖附近目标点",
    "踏浪矶附近目标点", "踏浪矶附近目标点",
    "叠翠屏附近目标点",
    "听雪轩附近目标点", "听雪轩附近目标点",
    "陆小凤附近目标点",
    "小凤路附近目标点", "小凤路附近目标点"
]

# print(f"已生成固定目标点：共{len(points_coords)}个节点，生成了{len(targets)}个目标点")
EXIT_NODE = [1, 27]